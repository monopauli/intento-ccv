<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>v0.18 | Trustless Hub</title>
    <meta name="generator" content="VuePress 1.8.2">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-XL9GNV1KHW"></script>
    <script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XL9GNV1KHW');</script>
    <meta name="description" content="For chains that were scaffolded with Trustless Hub versions lower than v0.18, changes are required to use Trustless Hub v0.18.">
    
    <link rel="preload" href="/assets/css/0.styles.0c602435.css" as="style"><link rel="preload" href="/assets/js/app.44790a85.js" as="script"><link rel="preload" href="/assets/js/22.e4bfc3f8.js" as="script"><link rel="preload" href="/assets/js/19.5af8f4e0.js" as="script"><link rel="preload" href="/assets/js/17.9461a3d9.js" as="script"><link rel="preload" href="/assets/js/23.67fc2bab.js" as="script"><link rel="preload" href="/assets/js/48.34ab597e.js" as="script"><link rel="preload" href="/assets/js/32.2ed5747b.js" as="script"><link rel="preload" href="/assets/js/8.7520c10b.js" as="script"><link rel="preload" href="/assets/js/5.eaddd7cc.js" as="script"><link rel="preload" href="/assets/js/78.72279344.js" as="script"><link rel="preload" href="/assets/js/2.865c2784.js" as="script"><link rel="preload" href="/assets/js/11.c7cf6f40.js" as="script"><link rel="preload" href="/assets/js/10.669adebc.js" as="script"><link rel="preload" href="/assets/js/18.102f6bd0.js" as="script"><link rel="prefetch" href="/assets/js/12.6863e83e.js"><link rel="prefetch" href="/assets/js/13.b9547e50.js"><link rel="prefetch" href="/assets/js/14.c45a094b.js"><link rel="prefetch" href="/assets/js/15.ebd43a43.js"><link rel="prefetch" href="/assets/js/16.4b8b5ba9.js"><link rel="prefetch" href="/assets/js/20.9b4dfd35.js"><link rel="prefetch" href="/assets/js/21.3dce4af3.js"><link rel="prefetch" href="/assets/js/24.953faef0.js"><link rel="prefetch" href="/assets/js/25.1147bfd1.js"><link rel="prefetch" href="/assets/js/26.8031a8a9.js"><link rel="prefetch" href="/assets/js/27.a3611fe4.js"><link rel="prefetch" href="/assets/js/28.f345bd54.js"><link rel="prefetch" href="/assets/js/29.0ad631d8.js"><link rel="prefetch" href="/assets/js/3.3d8dd966.js"><link rel="prefetch" href="/assets/js/30.266a5ab7.js"><link rel="prefetch" href="/assets/js/31.6ccc111d.js"><link rel="prefetch" href="/assets/js/33.ec51dd9f.js"><link rel="prefetch" href="/assets/js/34.39869b8e.js"><link rel="prefetch" href="/assets/js/35.78172f91.js"><link rel="prefetch" href="/assets/js/36.8cb2d755.js"><link rel="prefetch" href="/assets/js/37.b00537a4.js"><link rel="prefetch" href="/assets/js/38.ab055738.js"><link rel="prefetch" href="/assets/js/39.fb17957d.js"><link rel="prefetch" href="/assets/js/4.fce2dfc0.js"><link rel="prefetch" href="/assets/js/40.4dca1258.js"><link rel="prefetch" href="/assets/js/41.150ae8eb.js"><link rel="prefetch" href="/assets/js/42.a53e0eea.js"><link rel="prefetch" href="/assets/js/43.7aa8a7de.js"><link rel="prefetch" href="/assets/js/44.df2dbc1e.js"><link rel="prefetch" href="/assets/js/45.cd6349d0.js"><link rel="prefetch" href="/assets/js/46.6df452b2.js"><link rel="prefetch" href="/assets/js/47.a3bae866.js"><link rel="prefetch" href="/assets/js/49.e1b1877a.js"><link rel="prefetch" href="/assets/js/50.2728327f.js"><link rel="prefetch" href="/assets/js/51.fdd1578d.js"><link rel="prefetch" href="/assets/js/52.02c3588a.js"><link rel="prefetch" href="/assets/js/53.f5dd45b2.js"><link rel="prefetch" href="/assets/js/54.7fd0661f.js"><link rel="prefetch" href="/assets/js/55.d923336e.js"><link rel="prefetch" href="/assets/js/56.3fa8d031.js"><link rel="prefetch" href="/assets/js/57.ad8f4eea.js"><link rel="prefetch" href="/assets/js/58.c3947024.js"><link rel="prefetch" href="/assets/js/59.52d20d36.js"><link rel="prefetch" href="/assets/js/6.a17710f9.js"><link rel="prefetch" href="/assets/js/60.c1ea6dd2.js"><link rel="prefetch" href="/assets/js/61.717f8694.js"><link rel="prefetch" href="/assets/js/62.1d6cf0f4.js"><link rel="prefetch" href="/assets/js/63.6736e678.js"><link rel="prefetch" href="/assets/js/64.b9e92024.js"><link rel="prefetch" href="/assets/js/65.015ee581.js"><link rel="prefetch" href="/assets/js/66.29ad3426.js"><link rel="prefetch" href="/assets/js/67.07a8d880.js"><link rel="prefetch" href="/assets/js/68.4eb08767.js"><link rel="prefetch" href="/assets/js/69.85b6abb0.js"><link rel="prefetch" href="/assets/js/7.d103324f.js"><link rel="prefetch" href="/assets/js/70.44e16a2e.js"><link rel="prefetch" href="/assets/js/71.0f1e1538.js"><link rel="prefetch" href="/assets/js/72.70c18e26.js"><link rel="prefetch" href="/assets/js/73.1094a42e.js"><link rel="prefetch" href="/assets/js/74.baa3c381.js"><link rel="prefetch" href="/assets/js/75.3219c35a.js"><link rel="prefetch" href="/assets/js/76.c7014943.js"><link rel="prefetch" href="/assets/js/77.98ce34dd.js"><link rel="prefetch" href="/assets/js/9.7914407d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0c602435.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div data-v-58560e81><div data-v-40401285 data-v-58560e81><div class="banner-wrapper" data-v-40401285 data-v-40401285><div class="wrapper" data-v-40401285><div class="message" data-v-40401285>By using this website, you agree to our <a href="https://www.cookiesandyou.com" target="_blank" rel="noopener" style="color:#505FFF;" data-v-40401285>Cookie Policy</a>.</div> <div class="box" data-v-40401285><span class="icon-cross" data-v-40401285><svg width="16" height="16" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-40401285><path d="M1.66669 1.66669L12.3334 12.3334M12.3334 1.66669L1.66664 12.3334" stroke="#A2A3AD" stroke-width="1.5" stroke-linecap="round" data-v-40401285></path></svg></span></div></div></div></div><!----><div class="layout" data-v-58560e81><div class="layout__sidebar" data-v-58560e81><div style="height:100%;position:relative;" data-v-ab16c0b6 data-v-58560e81><div class="container" data-v-ab16c0b6><a href="/" class="logo__container router-link-active" data-v-ab16c0b6><div class="logo" data-v-ab16c0b6><div class="logo__img__custom" data-v-ab16c0b6><img src="/logo.svg" data-v-ab16c0b6></div><!----></div></a><div class="items footer__compact__false" data-v-ab16c0b6><div class="sidebar" style="display:block;" data-v-ab16c0b6><div class="title" data-v-ab16c0b6></div><!----></div><div class="sidebar" style="display:block;" data-v-ab16c0b6><div class="title" data-v-ab16c0b6>Resources</div><!----></div><div class="sidebar version" data-v-ab16c0b6><div data-v-08503e1b data-v-ab16c0b6><div class="container" data-v-08503e1b><span class="sr-only" data-v-08503e1b>Docs Version Switcher</span><!----></div></div></div></div><!----></div></div></div><div class="layout__main" data-v-58560e81><div class="layout__main__navbar" data-v-58560e81><div data-v-19189c02 data-v-58560e81><div class="container" data-v-19189c02><div class="menu" data-v-19189c02><div class="menu__icon" data-v-19189c02><svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#888" data-v-19189c02><path d="M2 5H22M2 12H22M2 19H22" stroke-width="1.5" stroke-linecap="round"></path></svg></div></div><div class="logo" data-v-19189c02><div class="logo__wrapper router-link-active" data-v-19189c02><div class="logo__image__custom" data-v-19189c02><img src="/logo.svg" class="logo__image__custom__img" data-v-19189c02></div><!----></div></div><div class="toolbar" data-v-19189c02><div class="toolbar__item" data-v-19189c02><div class="toolbar__item__icon" data-v-19189c02><svg width="100%" height="100%" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#888" data-v-19189c02><path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 2.75C6.66751 2.75 2.75 6.66751 2.75 11.5C2.75 16.3325 6.66751 20.25 11.5 20.25C13.6462 20.25 15.612 19.4773 17.1342 18.1949L22.6697 23.7303C22.9626 24.0232 23.4374 24.0232 23.7303 23.7303C24.0232 23.4374 24.0232 22.9626 23.7303 22.6697L18.1949 17.1342C19.4773 15.612 20.25 13.6462 20.25 11.5C20.25 6.66751 16.3325 2.75 11.5 2.75ZM16.6923 16.5599C17.9656 15.2535 18.75 13.4684 18.75 11.5C18.75 7.49594 15.5041 4.25 11.5 4.25C7.49594 4.25 4.25 7.49594 4.25 11.5C4.25 15.5041 7.49594 18.75 11.5 18.75C13.4684 18.75 15.2535 17.9656 16.5599 16.6923C16.5789 16.6679 16.5996 16.6444 16.622 16.622C16.6444 16.5996 16.6679 16.5789 16.6923 16.5599Z"></path></svg></div></div></div></div></div></div><div class="layout__main__content aside__true" data-v-58560e81><div id="content-scroll" class="layout__main__content__body" data-v-58560e81><div class="layout__main__content__body__breadcrumbs" data-v-58560e81><div data-v-48fb2d7a data-v-58560e81><div class="container" data-v-48fb2d7a><div class="crumbs" data-v-48fb2d7a><a href="/" class="crumbs__item router-link-active" data-v-48fb2d7a>Trustless Hub</a><a href="/migration/" aria-current="page" class="crumbs__item router-link-exact-active router-link-active" data-v-48fb2d7a>Upgrading a Blockchain to use Trustless Hub v0.18</a></div><div class="menu" data-v-48fb2d7a><div class="menu__item" style="visibility:visible;" data-v-48fb2d7a><svg width="100%" height="100%" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="menu__item__icon menu__item__icon__active__false" data-v-48fb2d7a><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 2C0.25 1.58579 0.585786 1.25 1 1.25H6C6.41421 1.25 6.75 1.58579 6.75 2C6.75 2.41421 6.41421 2.75 6 2.75H1C0.585786 2.75 0.25 2.41421 0.25 2ZM17.53 22.7803L16.9997 22.25L17.53 22.7803L17.5301 22.7802L17.5305 22.7798L17.5322 22.7781L17.5388 22.7715L17.5647 22.7456L17.6647 22.6456L18.0367 22.2737L19.2978 21.0126L22.53 17.7803C22.8229 17.4874 22.8229 17.0126 22.53 16.7197C22.2371 16.4268 21.7622 16.4268 21.4693 16.7197L18.2371 19.9519L17.7497 20.4393V8.5C17.7497 6.34186 17.0721 4.51182 15.7802 3.21983C14.4882 1.92783 12.6581 1.25031 10.5 1.25031C10.0858 1.25031 9.75 1.5861 9.75 2.00031C9.75 2.41453 10.0858 2.75031 10.5 2.75031C12.3419 2.75031 13.7617 3.32264 14.7195 4.28049C15.6773 5.23834 16.2497 6.65814 16.2497 8.5L16.2497 20.4393L12.53 16.7197C12.2371 16.4268 11.7622 16.4268 11.4693 16.7197C11.1764 17.0126 11.1764 17.4874 11.4693 17.7803L16.4693 22.7803L16.9997 23.3107L17.53 22.7803ZM1 6.25C0.585786 6.25 0.25 6.58579 0.25 7C0.25 7.41421 0.585786 7.75 1 7.75H10C10.4142 7.75 10.75 7.41421 10.75 7C10.75 6.58579 10.4142 6.25 10 6.25H1ZM0.25 12C0.25 11.5858 0.585786 11.25 1 11.25H12C12.4142 11.25 12.75 11.5858 12.75 12C12.75 12.4142 12.4142 12.75 12 12.75H1C0.585786 12.75 0.25 12.4142 0.25 12ZM1 16.25C0.585786 16.25 0.25 16.5858 0.25 17C0.25 17.4142 0.585786 17.75 1 17.75H8C8.41421 17.75 8.75 17.4142 8.75 17C8.75 16.5858 8.41421 16.25 8 16.25H1Z" data-v-48fb2d7a></path></svg><!----></div></div></div></div></div><div class="layout__main__content__body__wrapper" data-v-58560e81><div style="width:100%;" data-v-c85ed208 data-v-58560e81><div class="search__container" data-v-c85ed208><div class="search" data-v-c85ed208><div class="search__icon" data-v-c85ed208><svg width="100%" height="100%" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-c85ed208><path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 2.75C6.66751 2.75 2.75 6.66751 2.75 11.5C2.75 16.3325 6.66751 20.25 11.5 20.25C13.6462 20.25 15.612 19.4773 17.1342 18.1949L22.6697 23.7303C22.9626 24.0232 23.4374 24.0232 23.7303 23.7303C24.0232 23.4374 24.0232 22.9626 23.7303 22.6697L18.1949 17.1342C19.4773 15.612 20.25 13.6462 20.25 11.5C20.25 6.66751 16.3325 2.75 11.5 2.75ZM16.6923 16.5599C17.9656 15.2535 18.75 13.4684 18.75 11.5C18.75 7.49594 15.5041 4.25 11.5 4.25C7.49594 4.25 4.25 7.49594 4.25 11.5C4.25 15.5041 7.49594 18.75 11.5 18.75C13.4684 18.75 15.2535 17.9656 16.5599 16.6923C16.5789 16.6679 16.5996 16.6444 16.622 16.622C16.6444 16.5996 16.6679 16.5789 16.6923 16.5599Z"></path></svg></div><div class="search__text" data-v-c85ed208>Search</div></div></div><div class="container" data-v-c85ed208><div class="content__default" data-v-58560e81><h1 id="upgrading-a-blockchain-to-use-trustless-hub-v0-18"><a href="#upgrading-a-blockchain-to-use-trustless-hub-v0-18" class="header-anchor">#</a> Upgrading a Blockchain to use Trustless Hub v0.18</h1> <p>Trustless Hub v0.18 comes with Cosmos SDK v0.44. This version of Cosmos SDK introduced changes that are not compatible with chains that were scaffolded with Trustless Hub versions lower than v0.18.</p> <p><strong>Important:</strong> After upgrading from Trustless Hub v0.17.3 to Trustless Hub v0.18, you must update the default blockchain template to use blockchains that were scaffolded with earlier versions.</p> <p>These instructions are written for a blockchain that was scaffolded with the following command:</p> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>Trustless Hub scaffold chain github.com/cosmonaut/mars
</span></span></span></span> <!----></span> <!----></span></span> <p>If you used a different module path, replace <code>cosmonaut</code> and <code>mars</code> with the correct values for your blockchain.</p> <h2 id="blockchain"><a href="#blockchain" class="header-anchor">#</a> Blockchain</h2> <p>For each file listed, make the required changes to the source code of the blockchain template.</p> <h3 id="go-mod"><a href="#go-mod" class="header-anchor">#</a> go.mod</h3> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2>module github.com/cosmonaut/mars

go 1.16

require (
	github.com/cosmos/cosmos-sdk v0.44.0
	github.com/cosmos/ibc-go v1.2.0
	github.com/gogo/protobuf v1.3.3
	github.com/google/go-cmp v0.5.6 // indirect
	github.com/gorilla/mux v1.8.0
	github.com/grpc-ecosystem/grpc-gateway v1.16.0
	github.com/spf13/cast v1.3.1
	github.com/spf13/cobra v1.1.3
	github.com/stretchr/testify v1.7.0
	github.com/tendermint/spm v0.1.6
	github.com/tendermint/tendermint v0.34.13
	github.com/tendermint/tm-db v0.6.4
	google.golang.org/genproto v0.0.0-20210903162649-d08c68adba83
	google.golang.org/grpc v1.40.0
)

replace (
	github.com/99designs/keyring =&gt; github.com/cosmos/keyring v1.1.7-0.20210622111912-ef00f8ac3d76
	github.com/gogo/protobuf =&gt; github.com/regen-network/protobuf v1.3.3-alpha.regen.1
	google.golang.org/grpc =&gt; google.golang.org/grpc v1.33.2
)
</span></span></span></span> <!----></span> <!----></span></span> <h3 id="app-app-go"><a href="#app-app-go" class="header-anchor">#</a> app/app.go</h3> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2><span class="token keyword">import</span> <span class="token punctuation">(</span>
  <span class="token comment">//...</span>
  <span class="token comment">// Add the following packages:</span>
  <span class="token string">"github.com/cosmos/cosmos-sdk/x/feegrant"</span>
  feegrantkeeper <span class="token string">"github.com/cosmos/cosmos-sdk/x/feegrant/keeper"</span>
  feegrantmodule <span class="token string">"github.com/cosmos/cosmos-sdk/x/feegrant/module"</span>

  <span class="token string">"github.com/cosmos/ibc-go/modules/apps/transfer"</span>
  ibctransferkeeper <span class="token string">"github.com/cosmos/ibc-go/modules/apps/transfer/keeper"</span>
  ibctransfertypes <span class="token string">"github.com/cosmos/ibc-go/modules/apps/transfer/types"</span>
  ibc <span class="token string">"github.com/cosmos/ibc-go/modules/core"</span>
  ibcclient <span class="token string">"github.com/cosmos/ibc-go/modules/core/02-client"</span>
  ibcporttypes <span class="token string">"github.com/cosmos/ibc-go/modules/core/05-port/types"</span>
  ibchost <span class="token string">"github.com/cosmos/ibc-go/modules/core/24-host"</span>
  ibckeeper <span class="token string">"github.com/cosmos/ibc-go/modules/core/keeper"</span>
  
  <span class="token comment">// Remove the following packages:</span>
  <span class="token comment">// transfer "github.com/cosmos/cosmos-sdk/x/ibc/applications/transfer"</span>
  <span class="token comment">// ibctransferkeeper "github.com/cosmos/cosmos-sdk/x/ibc/applications/transfer/keeper"</span>
  <span class="token comment">// ibctransfertypes "github.com/cosmos/cosmos-sdk/x/ibc/applications/transfer/types"</span>
  <span class="token comment">// ibc "github.com/cosmos/cosmos-sdk/x/ibc/core"</span>
  <span class="token comment">// ibcclient "github.com/cosmos/cosmos-sdk/x/ibc/core/02-client"</span>
  <span class="token comment">// porttypes "github.com/cosmos/cosmos-sdk/x/ibc/core/05-port/types"</span>
  <span class="token comment">// ibchost "github.com/cosmos/cosmos-sdk/x/ibc/core/24-host"</span>
  <span class="token comment">// ibckeeper "github.com/cosmos/cosmos-sdk/x/ibc/core/keeper"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> <span class="token punctuation">(</span>
  <span class="token comment">//...</span>
  ModuleBasics <span class="token operator">=</span> module<span class="token punctuation">.</span><span class="token function">NewBasicManager</span><span class="token punctuation">(</span>
    <span class="token comment">//...</span>
    slashing<span class="token punctuation">.</span>AppModuleBasic<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// Add feegrantmodule.AppModuleBasic{},</span>
    feegrantmodule<span class="token punctuation">.</span>AppModuleBasic<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// &lt;--</span>
    ibc<span class="token punctuation">.</span>AppModuleBasic<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//...</span>
  <span class="token punctuation">)</span>
  <span class="token comment">//...</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> App <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  <span class="token comment">// Replace codec.Marshaler with codec.Codec</span>
  appCodec          codec<span class="token punctuation">.</span>Codec <span class="token comment">// &lt;--</span>
  <span class="token comment">// Add FeeGrantKeeper</span>
  FeeGrantKeeper   feegrantkeeper<span class="token punctuation">.</span>Keeper <span class="token comment">// &lt;--</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">New</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//bApp.SetAppVersion(version.Version)</span>
  bApp<span class="token punctuation">.</span><span class="token function">SetVersion</span><span class="token punctuation">(</span>version<span class="token punctuation">.</span>Version<span class="token punctuation">)</span> <span class="token comment">// &lt;--</span>

  keys <span class="token operator">:=</span> sdk<span class="token punctuation">.</span><span class="token function">NewKVStoreKeys</span><span class="token punctuation">(</span>
    <span class="token comment">//...</span>
    upgradetypes<span class="token punctuation">.</span>StoreKey<span class="token punctuation">,</span>
    <span class="token comment">// Add feegrant.StoreKey</span>
    feegrant<span class="token punctuation">.</span>StoreKey<span class="token punctuation">,</span> <span class="token comment">// &lt;--</span>
    evidencetypes<span class="token punctuation">.</span>StoreKey<span class="token punctuation">,</span>
    <span class="token comment">//...</span>
  <span class="token punctuation">)</span>

  app<span class="token punctuation">.</span>FeeGrantKeeper <span class="token operator">=</span> feegrantkeeper<span class="token punctuation">.</span><span class="token function">NewKeeper</span><span class="token punctuation">(</span>appCodec<span class="token punctuation">,</span> keys<span class="token punctuation">[</span>feegrant<span class="token punctuation">.</span>StoreKey<span class="token punctuation">]</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span>AccountKeeper<span class="token punctuation">)</span>  <span class="token comment">// &lt;--</span>
  <span class="token comment">// Add app.BaseApp as the last argument to upgradekeeper.NewKeeper</span>
  app<span class="token punctuation">.</span>UpgradeKeeper <span class="token operator">=</span> upgradekeeper<span class="token punctuation">.</span><span class="token function">NewKeeper</span><span class="token punctuation">(</span>skipUpgradeHeights<span class="token punctuation">,</span> keys<span class="token punctuation">[</span>upgradetypes<span class="token punctuation">.</span>StoreKey<span class="token punctuation">]</span><span class="token punctuation">,</span> appCodec<span class="token punctuation">,</span> homePath<span class="token punctuation">,</span> app<span class="token punctuation">.</span>BaseApp<span class="token punctuation">)</span>
  
  app<span class="token punctuation">.</span>IBCKeeper <span class="token operator">=</span> ibckeeper<span class="token punctuation">.</span><span class="token function">NewKeeper</span><span class="token punctuation">(</span>
    <span class="token comment">// Add app.UpgradeKeeper</span>
    appCodec<span class="token punctuation">,</span> keys<span class="token punctuation">[</span>ibchost<span class="token punctuation">.</span>StoreKey<span class="token punctuation">]</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span><span class="token function">GetSubspace</span><span class="token punctuation">(</span>ibchost<span class="token punctuation">.</span>ModuleName<span class="token punctuation">)</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span>StakingKeeper<span class="token punctuation">,</span> app<span class="token punctuation">.</span>UpgradeKeeper<span class="token punctuation">,</span> scopedIBCKeeper<span class="token punctuation">,</span>
  <span class="token punctuation">)</span>

  govRouter<span class="token punctuation">.</span><span class="token function">AddRoute</span><span class="token punctuation">(</span>govtypes<span class="token punctuation">.</span>RouterKey<span class="token punctuation">,</span> govtypes<span class="token punctuation">.</span>ProposalHandler<span class="token punctuation">)</span><span class="token punctuation">.</span>
    <span class="token comment">//...</span>
    <span class="token comment">// Replace NewClientUpdateProposalHandler with NewClientProposalHandler</span>
    <span class="token function">AddRoute</span><span class="token punctuation">(</span>ibchost<span class="token punctuation">.</span>RouterKey<span class="token punctuation">,</span> ibcclient<span class="token punctuation">.</span><span class="token function">NewClientProposalHandler</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>IBCKeeper<span class="token punctuation">.</span>ClientKeeper<span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token comment">// Replace porttypes with ibcporttypes</span>
  ibcRouter <span class="token operator">:=</span> ibcporttypes<span class="token punctuation">.</span><span class="token function">NewRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  app<span class="token punctuation">.</span>mm<span class="token punctuation">.</span><span class="token function">SetOrderBeginBlockers</span><span class="token punctuation">(</span>
    upgradetypes<span class="token punctuation">.</span>ModuleName<span class="token punctuation">,</span>
    <span class="token comment">// Add capabilitytypes.ModuleName,</span>
    capabilitytypes<span class="token punctuation">.</span>ModuleName<span class="token punctuation">,</span>
    minttypes<span class="token punctuation">.</span>ModuleName<span class="token punctuation">,</span>
    <span class="token comment">//...</span>
    <span class="token comment">// Add feegrant.ModuleName,</span>
    feegrant<span class="token punctuation">.</span>ModuleName<span class="token punctuation">,</span>
  <span class="token punctuation">)</span>

  <span class="token comment">// Add app.appCodec as an argument to module.NewConfigurator:</span>
  app<span class="token punctuation">.</span>mm<span class="token punctuation">.</span><span class="token function">RegisterServices</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span><span class="token function">NewConfigurator</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>appCodec<span class="token punctuation">,</span> app<span class="token punctuation">.</span><span class="token function">MsgServiceRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span><span class="token function">GRPCQueryRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  
  <span class="token comment">// Replace:</span>
  <span class="token comment">// app.SetAnteHandler(</span>
  <span class="token comment">// 	ante.NewAnteHandler(</span>
  <span class="token comment">// 		app.AccountKeeper, app.BankKeeper, ante.DefaultSigVerificationGasConsumer,</span>
  <span class="token comment">// 		encodingConfig.TxConfig.SignModeHandler(),</span>
  <span class="token comment">// 	),</span>
  <span class="token comment">// )</span>

  <span class="token comment">// With the following:</span>
  anteHandler<span class="token punctuation">,</span> err <span class="token operator">:=</span> ante<span class="token punctuation">.</span><span class="token function">NewAnteHandler</span><span class="token punctuation">(</span>
    ante<span class="token punctuation">.</span>HandlerOptions<span class="token punctuation">{</span>
      AccountKeeper<span class="token punctuation">:</span>   app<span class="token punctuation">.</span>AccountKeeper<span class="token punctuation">,</span>
      BankKeeper<span class="token punctuation">:</span>      app<span class="token punctuation">.</span>BankKeeper<span class="token punctuation">,</span>
      SignModeHandler<span class="token punctuation">:</span> encodingConfig<span class="token punctuation">.</span>TxConfig<span class="token punctuation">.</span><span class="token function">SignModeHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      FeegrantKeeper<span class="token punctuation">:</span>  app<span class="token punctuation">.</span>FeeGrantKeeper<span class="token punctuation">,</span>
      SigGasConsumer<span class="token punctuation">:</span>  ante<span class="token punctuation">.</span>DefaultSigVerificationGasConsumer<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span>
  <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  app<span class="token punctuation">.</span><span class="token function">SetAnteHandler</span><span class="token punctuation">(</span>anteHandler<span class="token punctuation">)</span>

  <span class="token comment">// Remove the following:</span>
  <span class="token comment">// ctx := app.BaseApp.NewUncachedContext(true, tmproto.Header{})</span>
  <span class="token comment">// app.CapabilityKeeper.InitializeAndSeal(ctx)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>app <span class="token operator">*</span>App<span class="token punctuation">)</span> <span class="token function">InitChainer</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req abci<span class="token punctuation">.</span>RequestInitChain<span class="token punctuation">)</span> abci<span class="token punctuation">.</span>ResponseInitChain <span class="token punctuation">{</span>
  <span class="token keyword">var</span> genesisState GenesisState
  <span class="token keyword">if</span> err <span class="token operator">:=</span> tmjson<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>AppStateBytes<span class="token punctuation">,</span> <span class="token operator">&amp;</span>genesisState<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Add the following:</span>
  app<span class="token punctuation">.</span>UpgradeKeeper<span class="token punctuation">.</span><span class="token function">SetModuleVersionMap</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> app<span class="token punctuation">.</span>mm<span class="token punctuation">.</span><span class="token function">GetVersionMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> app<span class="token punctuation">.</span>mm<span class="token punctuation">.</span><span class="token function">InitGenesis</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> app<span class="token punctuation">.</span>appCodec<span class="token punctuation">,</span> genesisState<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Replace Marshaler with Codec</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>app <span class="token operator">*</span>App<span class="token punctuation">)</span> <span class="token function">AppCodec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> codec<span class="token punctuation">.</span>Codec <span class="token punctuation">{</span>
  <span class="token keyword">return</span> app<span class="token punctuation">.</span>appCodec
<span class="token punctuation">}</span>

<span class="token comment">// Replace BinaryMarshaler with BinaryCodec</span>
<span class="token keyword">func</span> <span class="token function">initParamsKeeper</span><span class="token punctuation">(</span>appCodec codec<span class="token punctuation">.</span>BinaryCodec<span class="token punctuation">,</span> legacyAmino <span class="token operator">*</span>codec<span class="token punctuation">.</span>LegacyAmino<span class="token punctuation">,</span> key<span class="token punctuation">,</span> tkey sdk<span class="token punctuation">.</span>StoreKey<span class="token punctuation">)</span> paramskeeper<span class="token punctuation">.</span>Keeper <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <!----></span></span> <h3 id="app-genesis-go"><a href="#app-genesis-go" class="header-anchor">#</a> app/genesis.go</h3> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2><span class="token comment">// Replace codec.JSONMarshaler with codec.JSONCodec</span>
<span class="token keyword">func</span> <span class="token function">NewDefaultGenesisState</span><span class="token punctuation">(</span>cdc codec<span class="token punctuation">.</span>JSONCodec<span class="token punctuation">)</span> GenesisState <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <!----></span></span> <h3 id="testutil-keeper-mars-go"><a href="#testutil-keeper-mars-go" class="header-anchor">#</a> testutil/keeper/mars.go</h3> <p>Add the following code:</p> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2><span class="token keyword">package</span> keeper

<span class="token keyword">import</span> <span class="token punctuation">(</span>
  <span class="token string">"testing"</span>

  <span class="token string">"github.com/cosmonaut/mars/x/mars/keeper"</span>
  <span class="token string">"github.com/cosmonaut/mars/x/mars/types"</span>
  <span class="token string">"github.com/cosmos/cosmos-sdk/codec"</span>
  codectypes <span class="token string">"github.com/cosmos/cosmos-sdk/codec/types"</span>
  <span class="token string">"github.com/cosmos/cosmos-sdk/store"</span>
  storetypes <span class="token string">"github.com/cosmos/cosmos-sdk/store/types"</span>
  sdk <span class="token string">"github.com/cosmos/cosmos-sdk/types"</span>
  <span class="token string">"github.com/stretchr/testify/require"</span>
  <span class="token string">"github.com/tendermint/tendermint/libs/log"</span>
  tmproto <span class="token string">"github.com/tendermint/tendermint/proto/tendermint/types"</span>
  tmdb <span class="token string">"github.com/tendermint/tm-db"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">MarsKeeper</span><span class="token punctuation">(</span>t testing<span class="token punctuation">.</span>TB<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>keeper<span class="token punctuation">.</span>Keeper<span class="token punctuation">,</span> sdk<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  storeKey <span class="token operator">:=</span> sdk<span class="token punctuation">.</span><span class="token function">NewKVStoreKey</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span>StoreKey<span class="token punctuation">)</span>
  memStoreKey <span class="token operator">:=</span> storetypes<span class="token punctuation">.</span><span class="token function">NewMemoryStoreKey</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span>MemStoreKey<span class="token punctuation">)</span>

  db <span class="token operator">:=</span> tmdb<span class="token punctuation">.</span><span class="token function">NewMemDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  stateStore <span class="token operator">:=</span> store<span class="token punctuation">.</span><span class="token function">NewCommitMultiStore</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span>
  stateStore<span class="token punctuation">.</span><span class="token function">MountStoreWithDB</span><span class="token punctuation">(</span>storeKey<span class="token punctuation">,</span> sdk<span class="token punctuation">.</span>StoreTypeIAVL<span class="token punctuation">,</span> db<span class="token punctuation">)</span>
  stateStore<span class="token punctuation">.</span><span class="token function">MountStoreWithDB</span><span class="token punctuation">(</span>memStoreKey<span class="token punctuation">,</span> sdk<span class="token punctuation">.</span>StoreTypeMemory<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
  require<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> stateStore<span class="token punctuation">.</span><span class="token function">LoadLatestVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  registry <span class="token operator">:=</span> codectypes<span class="token punctuation">.</span><span class="token function">NewInterfaceRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  k <span class="token operator">:=</span> keeper<span class="token punctuation">.</span><span class="token function">NewKeeper</span><span class="token punctuation">(</span>
    codec<span class="token punctuation">.</span><span class="token function">NewProtoCodec</span><span class="token punctuation">(</span>registry<span class="token punctuation">)</span><span class="token punctuation">,</span>
    storeKey<span class="token punctuation">,</span>
    memStoreKey<span class="token punctuation">,</span>
  <span class="token punctuation">)</span>

  ctx <span class="token operator">:=</span> sdk<span class="token punctuation">.</span><span class="token function">NewContext</span><span class="token punctuation">(</span>stateStore<span class="token punctuation">,</span> tmproto<span class="token punctuation">.</span>Header<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> log<span class="token punctuation">.</span><span class="token function">NewNopLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> k<span class="token punctuation">,</span> ctx
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <!----></span></span> <p>If <code>mars</code> is an IBC-enabled module, add the following code, instead:</p> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2><span class="token keyword">package</span> keeper

<span class="token keyword">import</span> <span class="token punctuation">(</span>
  <span class="token string">"testing"</span>

  <span class="token string">"github.com/cosmonaut/test/x/mars/keeper"</span>
  <span class="token string">"github.com/cosmonaut/test/x/mars/types"</span>
  <span class="token string">"github.com/cosmos/cosmos-sdk/codec"</span>
  codectypes <span class="token string">"github.com/cosmos/cosmos-sdk/codec/types"</span>
  <span class="token string">"github.com/cosmos/cosmos-sdk/store"</span>
  storetypes <span class="token string">"github.com/cosmos/cosmos-sdk/store/types"</span>
  sdk <span class="token string">"github.com/cosmos/cosmos-sdk/types"</span>
  capabilitykeeper <span class="token string">"github.com/cosmos/cosmos-sdk/x/capability/keeper"</span>
  typesparams <span class="token string">"github.com/cosmos/cosmos-sdk/x/params/types"</span>
  ibckeeper <span class="token string">"github.com/cosmos/ibc-go/modules/core/keeper"</span>
  <span class="token string">"github.com/stretchr/testify/require"</span>
  <span class="token string">"github.com/tendermint/tendermint/libs/log"</span>
  tmproto <span class="token string">"github.com/tendermint/tendermint/proto/tendermint/types"</span>
  tmdb <span class="token string">"github.com/tendermint/tm-db"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">MarsKeeper</span><span class="token punctuation">(</span>t testing<span class="token punctuation">.</span>TB<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>keeper<span class="token punctuation">.</span>Keeper<span class="token punctuation">,</span> sdk<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  logger <span class="token operator">:=</span> log<span class="token punctuation">.</span><span class="token function">NewNopLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  storeKey <span class="token operator">:=</span> sdk<span class="token punctuation">.</span><span class="token function">NewKVStoreKey</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span>StoreKey<span class="token punctuation">)</span>
  memStoreKey <span class="token operator">:=</span> storetypes<span class="token punctuation">.</span><span class="token function">NewMemoryStoreKey</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span>MemStoreKey<span class="token punctuation">)</span>

  db <span class="token operator">:=</span> tmdb<span class="token punctuation">.</span><span class="token function">NewMemDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  stateStore <span class="token operator">:=</span> store<span class="token punctuation">.</span><span class="token function">NewCommitMultiStore</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span>
  stateStore<span class="token punctuation">.</span><span class="token function">MountStoreWithDB</span><span class="token punctuation">(</span>storeKey<span class="token punctuation">,</span> sdk<span class="token punctuation">.</span>StoreTypeIAVL<span class="token punctuation">,</span> db<span class="token punctuation">)</span>
  stateStore<span class="token punctuation">.</span><span class="token function">MountStoreWithDB</span><span class="token punctuation">(</span>memStoreKey<span class="token punctuation">,</span> sdk<span class="token punctuation">.</span>StoreTypeMemory<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
  require<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> stateStore<span class="token punctuation">.</span><span class="token function">LoadLatestVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  registry <span class="token operator">:=</span> codectypes<span class="token punctuation">.</span><span class="token function">NewInterfaceRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  appCodec <span class="token operator">:=</span> codec<span class="token punctuation">.</span><span class="token function">NewProtoCodec</span><span class="token punctuation">(</span>registry<span class="token punctuation">)</span>
  capabilityKeeper <span class="token operator">:=</span> capabilitykeeper<span class="token punctuation">.</span><span class="token function">NewKeeper</span><span class="token punctuation">(</span>appCodec<span class="token punctuation">,</span> storeKey<span class="token punctuation">,</span> memStoreKey<span class="token punctuation">)</span>

  amino <span class="token operator">:=</span> codec<span class="token punctuation">.</span><span class="token function">NewLegacyAmino</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  ss <span class="token operator">:=</span> typesparams<span class="token punctuation">.</span><span class="token function">NewSubspace</span><span class="token punctuation">(</span>appCodec<span class="token punctuation">,</span>
    amino<span class="token punctuation">,</span>
    storeKey<span class="token punctuation">,</span>
    memStoreKey<span class="token punctuation">,</span>
    <span class="token string">"MarsSubSpace"</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span>
  IBCKeeper <span class="token operator">:=</span> ibckeeper<span class="token punctuation">.</span><span class="token function">NewKeeper</span><span class="token punctuation">(</span>
    appCodec<span class="token punctuation">,</span>
    storeKey<span class="token punctuation">,</span>
    ss<span class="token punctuation">,</span>
    <span class="token boolean">nil</span><span class="token punctuation">,</span>
    <span class="token boolean">nil</span><span class="token punctuation">,</span>
    capabilityKeeper<span class="token punctuation">.</span><span class="token function">ScopeToModule</span><span class="token punctuation">(</span><span class="token string">"MarsIBCKeeper"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span>

  k <span class="token operator">:=</span> keeper<span class="token punctuation">.</span><span class="token function">NewKeeper</span><span class="token punctuation">(</span>
    codec<span class="token punctuation">.</span><span class="token function">NewProtoCodec</span><span class="token punctuation">(</span>registry<span class="token punctuation">)</span><span class="token punctuation">,</span>
    storeKey<span class="token punctuation">,</span>
    memStoreKey<span class="token punctuation">,</span>
    IBCKeeper<span class="token punctuation">.</span>ChannelKeeper<span class="token punctuation">,</span>
    <span class="token operator">&amp;</span>IBCKeeper<span class="token punctuation">.</span>PortKeeper<span class="token punctuation">,</span>
    capabilityKeeper<span class="token punctuation">.</span><span class="token function">ScopeToModule</span><span class="token punctuation">(</span><span class="token string">"MarsScopedKeeper"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span>

  ctx <span class="token operator">:=</span> sdk<span class="token punctuation">.</span><span class="token function">NewContext</span><span class="token punctuation">(</span>stateStore<span class="token punctuation">,</span> tmproto<span class="token punctuation">.</span>Header<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> logger<span class="token punctuation">)</span>
  <span class="token keyword">return</span> k<span class="token punctuation">,</span> ctx
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <!----></span></span> <h3 id="testutil-network-network-go"><a href="#testutil-network-network-go" class="header-anchor">#</a> testutil/network/network.go</h3> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2><span class="token keyword">func</span> <span class="token function">DefaultConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> network<span class="token punctuation">.</span>Config <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  <span class="token keyword">return</span> network<span class="token punctuation">.</span>Config<span class="token punctuation">{</span>
    <span class="token comment">//...</span>
    <span class="token comment">// Add sdk.DefaultPowerReduction</span>
    AccountTokens<span class="token punctuation">:</span>   sdk<span class="token punctuation">.</span><span class="token function">TokensFromConsensusPower</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> sdk<span class="token punctuation">.</span>DefaultPowerReduction<span class="token punctuation">)</span><span class="token punctuation">,</span>
    StakingTokens<span class="token punctuation">:</span>   sdk<span class="token punctuation">.</span><span class="token function">TokensFromConsensusPower</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> sdk<span class="token punctuation">.</span>DefaultPowerReduction<span class="token punctuation">)</span><span class="token punctuation">,</span>
    BondedTokens<span class="token punctuation">:</span>    sdk<span class="token punctuation">.</span><span class="token function">TokensFromConsensusPower</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> sdk<span class="token punctuation">.</span>DefaultPowerReduction<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">//...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <!----></span></span> <h3 id="testutil-sample-sample-go"><a href="#testutil-sample-sample-go" class="header-anchor">#</a> testutil/sample/sample.go</h3> <p>Add the following code:</p> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2><span class="token keyword">package</span> sample

<span class="token keyword">import</span> <span class="token punctuation">(</span>
  <span class="token string">"github.com/cosmos/cosmos-sdk/crypto/keys/ed25519"</span>
  sdk <span class="token string">"github.com/cosmos/cosmos-sdk/types"</span>
<span class="token punctuation">)</span>

<span class="token comment">// AccAddress returns a sample account address</span>
<span class="token keyword">func</span> <span class="token function">AccAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  pk <span class="token operator">:=</span> ed25519<span class="token punctuation">.</span><span class="token function">GenPrivKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">PubKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  addr <span class="token operator">:=</span> pk<span class="token punctuation">.</span><span class="token function">Address</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> sdk<span class="token punctuation">.</span><span class="token function">AccAddress</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <!----></span></span> <h3 id="bandchain-support"><a href="#bandchain-support" class="header-anchor">#</a> BandChain Support</h3> <p>If your module includes integration with BandChain, added manually or scaffolded with <code>Trustless Hub scaffold band</code>, upgrade the <code>github.com/bandprotocol/bandchain-packet</code> package to <code>v0.0.2</code> in <code>go.mod</code>.</p> <h2 id="module"><a href="#module" class="header-anchor">#</a> Module</h2> <h3 id="x-mars-keeper-keeper-go"><a href="#x-mars-keeper-keeper-go" class="header-anchor">#</a> x/mars/keeper/keeper.go</h3> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2><span class="token keyword">type</span> <span class="token punctuation">(</span>
  Keeper <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token comment">// Replace Marshaler with BinaryCodec</span>
    cdc      codec<span class="token punctuation">.</span>BinaryCodec
    <span class="token comment">//...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">NewKeeper</span><span class="token punctuation">(</span>
  <span class="token comment">// Replace Marshaler with BinaryCodec</span>
  cdc codec<span class="token punctuation">.</span>BinaryCodec<span class="token punctuation">,</span>
  <span class="token comment">//...</span>
<span class="token punctuation">)</span> <span class="token operator">*</span>Keeper <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <!----></span></span> <h3 id="x-mars-keeper-msg-server-test-go"><a href="#x-mars-keeper-msg-server-test-go" class="header-anchor">#</a> x/mars/keeper/msg_server_test.go</h3> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2><span class="token keyword">package</span> keeper_test

<span class="token keyword">import</span> <span class="token punctuation">(</span>
  <span class="token comment">//...</span>
  <span class="token comment">// Add the following:</span>
  keepertest <span class="token string">"github.com/cosmonaut/mars/testutil/keeper"</span>
  <span class="token string">"github.com/cosmonaut/mars/x/mars/keeper"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">setupMsgServer</span><span class="token punctuation">(</span>t testing<span class="token punctuation">.</span>TB<span class="token punctuation">)</span> <span class="token punctuation">(</span>types<span class="token punctuation">.</span>MsgServer<span class="token punctuation">,</span> context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Replace</span>
  <span class="token comment">// keeper, ctx := setupKeeper(t)</span>
  <span class="token comment">// return NewMsgServerImpl(*keeper), sdk.WrapSDKContext(ctx)</span>

  <span class="token comment">// With the following:</span>
  k<span class="token punctuation">,</span> ctx <span class="token operator">:=</span> keepertest<span class="token punctuation">.</span><span class="token function">MarsKeeper</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
  <span class="token keyword">return</span> keeper<span class="token punctuation">.</span><span class="token function">NewMsgServerImpl</span><span class="token punctuation">(</span><span class="token operator">*</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span> sdk<span class="token punctuation">.</span><span class="token function">WrapSDKContext</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <!----></span></span> <h3 id="x-mars-module-go"><a href="#x-mars-module-go" class="header-anchor">#</a> x/mars/module.go</h3> <span class="codeblock" data-v-1eda75b2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-1eda75b2><span class="body__container" data-v-1eda75b2><span class="body__block" data-v-1eda75b2><span class="icons" data-v-1eda75b2><!----> <span class="icons__item" data-v-1eda75b2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-1eda75b2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-1eda75b2></path></svg> <span class="icons__item__tooltip" data-v-1eda75b2>
              Copy
            </span></span></span> <span class="body" data-v-1eda75b2><span class="body__wrapper" data-v-1eda75b2><span class="body__code" data-v-1eda75b2><span class="token keyword">type</span> AppModuleBasic <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  <span class="token comment">// Replace Marshaler with BinaryCodec</span>
  cdc codec<span class="token punctuation">.</span>BinaryCodec
<span class="token punctuation">}</span>

<span class="token comment">// Replace Marshaler with BinaryCodec</span>
<span class="token keyword">func</span> <span class="token function">NewAppModuleBasic</span><span class="token punctuation">(</span>cdc codec<span class="token punctuation">.</span>BinaryCodec<span class="token punctuation">)</span> AppModuleBasic <span class="token punctuation">{</span>
  <span class="token keyword">return</span> AppModuleBasic<span class="token punctuation">{</span>cdc<span class="token punctuation">:</span> cdc<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Replace JSONMarshaler with JSONCodec</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>AppModuleBasic<span class="token punctuation">)</span> <span class="token function">DefaultGenesis</span><span class="token punctuation">(</span>cdc codec<span class="token punctuation">.</span>JSONCodec<span class="token punctuation">)</span> json<span class="token punctuation">.</span>RawMessage <span class="token punctuation">{</span>
  <span class="token keyword">return</span> cdc<span class="token punctuation">.</span><span class="token function">MustMarshalJSON</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token function">DefaultGenesis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Replace JSONMarshaler with JSONCodec</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>AppModuleBasic<span class="token punctuation">)</span> <span class="token function">ValidateGenesis</span><span class="token punctuation">(</span>cdc codec<span class="token punctuation">.</span>JSONCodec<span class="token punctuation">,</span> config client<span class="token punctuation">.</span>TxEncodingConfig<span class="token punctuation">,</span> bz json<span class="token punctuation">.</span>RawMessage<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span>

<span class="token comment">// Replace codec.Marshaller with codec.Codec</span>
<span class="token keyword">func</span> <span class="token function">NewAppModule</span><span class="token punctuation">(</span>cdc codec<span class="token punctuation">.</span>Codec<span class="token punctuation">,</span> keeper keeper<span class="token punctuation">.</span>Keeper<span class="token punctuation">)</span> AppModule <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span>

<span class="token comment">// Replace JSONMarshaler with JSONCodec</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>am AppModule<span class="token punctuation">)</span> <span class="token function">InitGenesis</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> cdc codec<span class="token punctuation">.</span>JSONCodec<span class="token punctuation">,</span> gs json<span class="token punctuation">.</span>RawMessage<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>abci<span class="token punctuation">.</span>ValidatorUpdate <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span>

<span class="token comment">// Replace JSONMarshaler with JSONCodec</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>am AppModule<span class="token punctuation">)</span> <span class="token function">ExportGenesis</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> cdc codec<span class="token punctuation">.</span>JSONCodec<span class="token punctuation">)</span> json<span class="token punctuation">.</span>RawMessage <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span>

<span class="token comment">// Add the following</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span> <span class="token function">ConsensusVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">uint64</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">2</span> <span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <!----></span></span></div><!----></div></div></div></div><div class="layout__main__content__aside__container" style="--height-banners:nullpx;" data-v-58560e81><div class="layout__main__content__aside aside__bottom__false" data-v-58560e81><!----></div><!----></div></div><div class="layout__main__gutter" data-v-58560e81><div data-v-15325c0d data-v-58560e81><div class="links" data-v-15325c0d><div class="links__wrapper" data-v-15325c0d><!----></div><div class="links__wrapper" data-v-15325c0d><div class="links__container" data-v-15325c0d><a href="/cli/" class="links__item links__item__right" data-v-15325c0d><div data-v-15325c0d><div class="links__label" data-v-15325c0d>Next</div><div class="links__item__title" data-v-15325c0d>CLI Reference</div><div class="links__item__desc" data-v-15325c0d><div>Trustless Hub CLI docs.</div></div></div><div class="links__item__icon" data-v-15325c0d><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 64 64" data-v-15325c0d><title data-v-15325c0d>arrow-right</title><g stroke-linecap="square" stroke-linejoin="miter" stroke-width="2" data-v-15325c0d><line fill="none" stroke-miterlimit="10" x1="3" y1="32" x2="61" y2="32" stroke-linecap="butt" data-v-15325c0d></line><polyline fill="none" stroke-miterlimit="10" points="43,14 61,32 43,50 " data-v-15325c0d></polyline></g></svg></div></a></div></div></div></div></div><div class="layout__main__footer" data-v-58560e81><div data-v-732a47ec data-v-58560e81><div class="wrapper" data-v-732a47ec><div class="container" data-v-732a47ec><div class="footer__wrapper" data-v-732a47ec><!----><!----><div class="logo" data-v-732a47ec><div class="logo__item" data-v-732a47ec><a href="https://www.trustlesshub.com/" target="_blank" rel="noreferrer noopener" tag="div" class="logo__image" data-v-732a47ec><img data-v-732a47ec></a></div><div class="logo__item logo__link" data-v-732a47ec><a href="https://danieldijkstra.medium.com/" target="_blank" title="medium" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-732a47ec><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-732a47ec><path d="M24 24h-24v-24h24v24zm-4.03-5.649v-.269l-1.247-1.224c-.11-.084-.165-.222-.142-.359v-8.998c-.023-.137.032-.275.142-.359l1.277-1.224v-.269h-4.422l-3.152 7.863-3.586-7.863h-4.638v.269l1.494 1.799c.146.133.221.327.201.523v7.072c.044.255-.037.516-.216.702l-1.681 2.038v.269h4.766v-.269l-1.681-2.038c-.181-.186-.266-.445-.232-.702v-6.116l4.183 9.125h.486l3.593-9.125v7.273c0 .194 0 .232-.127.359l-1.292 1.254v.269h6.274z" data-v-732a47ec></path></svg></a><a href="https://twitter.com/trustlesshub" target="_blank" title="twitter" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-732a47ec><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-732a47ec><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z" data-v-732a47ec></path></svg></a><a href="https://reddit.com/r/trustlesshub" target="_blank" title="reddit" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-732a47ec><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-732a47ec><path d="M14.238 15.348c.085.084.085.221 0 .306-.465.462-1.194.687-2.231.687l-.008-.002-.008.002c-1.036 0-1.766-.225-2.231-.688-.085-.084-.085-.221 0-.305.084-.084.222-.084.307 0 .379.377 1.008.561 1.924.561l.008.002.008-.002c.915 0 1.544-.184 1.924-.561.085-.084.223-.084.307 0zm-3.44-2.418c0-.507-.414-.919-.922-.919-.509 0-.923.412-.923.919 0 .506.414.918.923.918.508.001.922-.411.922-.918zm13.202-.93c0 6.627-5.373 12-12 12s-12-5.373-12-12 5.373-12 12-12 12 5.373 12 12zm-5-.129c0-.851-.695-1.543-1.55-1.543-.417 0-.795.167-1.074.435-1.056-.695-2.485-1.137-4.066-1.194l.865-2.724 2.343.549-.003.034c0 .696.569 1.262 1.268 1.262.699 0 1.267-.566 1.267-1.262s-.568-1.262-1.267-1.262c-.537 0-.994.335-1.179.804l-2.525-.592c-.11-.027-.223.037-.257.145l-.965 3.038c-1.656.02-3.155.466-4.258 1.181-.277-.255-.644-.415-1.05-.415-.854.001-1.549.693-1.549 1.544 0 .566.311 1.056.768 1.325-.03.164-.05.331-.05.5 0 2.281 2.805 4.137 6.253 4.137s6.253-1.856 6.253-4.137c0-.16-.017-.317-.044-.472.486-.261.82-.766.82-1.353zm-4.872.141c-.509 0-.922.412-.922.919 0 .506.414.918.922.918s.922-.412.922-.918c0-.507-.413-.919-.922-.919z" data-v-732a47ec></path></svg></a><a href="https://discord.gg/vcExX9T" target="_blank" title="discord" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-732a47ec><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-732a47ec><path d="M19.54 0c1.356 0 2.46 1.104 2.46 2.472v21.528l-2.58-2.28-1.452-1.344-1.536-1.428.636 2.22h-13.608c-1.356 0-2.46-1.104-2.46-2.472v-16.224c0-1.368 1.104-2.472 2.46-2.472h16.08zm-4.632 15.672c2.652-.084 3.672-1.824 3.672-1.824 0-3.864-1.728-6.996-1.728-6.996-1.728-1.296-3.372-1.26-3.372-1.26l-.168.192c2.04.624 2.988 1.524 2.988 1.524-1.248-.684-2.472-1.02-3.612-1.152-.864-.096-1.692-.072-2.424.024l-.204.024c-.42.036-1.44.192-2.724.756-.444.204-.708.348-.708.348s.996-.948 3.156-1.572l-.12-.144s-1.644-.036-3.372 1.26c0 0-1.728 3.132-1.728 6.996 0 0 1.008 1.74 3.66 1.824 0 0 .444-.54.804-.996-1.524-.456-2.1-1.416-2.1-1.416l.336.204.048.036.047.027.014.006.047.027c.3.168.6.3.876.408.492.192 1.08.384 1.764.516.9.168 1.956.228 3.108.012.564-.096 1.14-.264 1.74-.516.42-.156.888-.384 1.38-.708 0 0-.6.984-2.172 1.428.36.456.792.972.792.972zm-5.58-5.604c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332.012-.732-.54-1.332-1.224-1.332zm4.38 0c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332 0-.732-.54-1.332-1.224-1.332z" data-v-732a47ec></path></svg></a><a href="https://www.youtube.com/channel/UCia6iAp3VqLDeEQMoU9zt2w" target="_blank" title="youtube" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-732a47ec><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-732a47ec><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z" data-v-732a47ec></path></svg></a></div></div><div class="smallprint" data-v-732a47ec><div class="smallprint__item smallprint__item__links" data-v-732a47ec><a href="https://www.trustlesshub.com/" data-v-732a47ec>Trustless Hub</a></div><div class="smallprint__item__desc smallprint__item" data-v-732a47ec><div>This website is maintained by Tendermint Inc. The contents and opinions of this website are those of Tendermint Inc.</div></div></div></div></div></div></div></div></div></div><div class="sheet__sidebar" data-v-ec82e5e0 data-v-58560e81><!----> <!----></div><div class="sheet__sidebar" data-v-ec82e5e0 data-v-58560e81><!----> <!----></div><div class="sheet__sidebar sheet__sidebar__toc" data-v-ec82e5e0 data-v-58560e81><!----> <!----></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.44790a85.js" defer></script><script src="/assets/js/22.e4bfc3f8.js" defer></script><script src="/assets/js/19.5af8f4e0.js" defer></script><script src="/assets/js/17.9461a3d9.js" defer></script><script src="/assets/js/23.67fc2bab.js" defer></script><script src="/assets/js/48.34ab597e.js" defer></script><script src="/assets/js/32.2ed5747b.js" defer></script><script src="/assets/js/8.7520c10b.js" defer></script><script src="/assets/js/5.eaddd7cc.js" defer></script><script src="/assets/js/78.72279344.js" defer></script><script src="/assets/js/2.865c2784.js" defer></script><script src="/assets/js/11.c7cf6f40.js" defer></script><script src="/assets/js/10.669adebc.js" defer></script><script src="/assets/js/18.102f6bd0.js" defer></script>
  </body>
</html>
