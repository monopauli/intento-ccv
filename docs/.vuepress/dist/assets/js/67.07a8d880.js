(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{582:function(c,l,a){"use strict";a.r(l);var d=a(0),e=Object(d.a)({},(function(){var c=this,l=c.$createElement,a=c._self._c||l;return a("ContentSlotsDistributor",{attrs:{"slot-key":c.$parent.slotKey}},[a("h1",{attrs:{id:"bandchain-oracle-scaffold"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bandchain-oracle-scaffold"}},[c._v("#")]),c._v(" BandChain Oracle Scaffold")]),c._v(" "),a("p",[c._v("BandChainâ€™s Oracle module is a communication module built-in compliance with IBC protocol which can query data points of various types from BandChain. In addition, other chains can ask our Oracle module for real-time information according to their needs.\nBandChain has multiples scripts deployed into the network, and we can request any data using the script id.")]),c._v(" "),a("h2",{attrs:{id:"ibc-module-packet-scaffold"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ibc-module-packet-scaffold"}},[c._v("#")]),c._v(" IBC Module Packet Scaffold")]),c._v(" "),a("p",[c._v("BandChain oracle queries can be scaffolded only in IBC modules.")]),c._v(" "),a("p",[c._v("To scaffold an oracle:")]),c._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"VHJ1c3RsZXNzIEh1YiBzY2FmZm9sZCBiYW5kIFtxdWVyeU5hbWVdIC0tbW9kdWxlIFttb2R1bGVOYW1lXQo="}}),c._v(" "),a("h3",{attrs:{id:"acknowledgement"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#acknowledgement"}},[c._v("#")]),c._v(" Acknowledgement")]),c._v(" "),a("p",[c._v("The BandChain oracle will return the ack messages with the request's id, and we save the last request id for future queries.")]),c._v(" "),a("h2",{attrs:{id:"files-and-directories"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#files-and-directories"}},[c._v("#")]),c._v(" Files and Directories")]),c._v(" "),a("p",[c._v("When you scaffold a BandChain oracle, the following files and directories are created and modified:")]),c._v(" "),a("ul",[a("li",[a("code",[c._v("proto")]),c._v(": oracle request and response data.")]),c._v(" "),a("li",[a("code",[c._v("x/module_name/keeper")]),c._v(": IBC hooks, gRPC message server.")]),c._v(" "),a("li",[a("code",[c._v("x/module_name/types")]),c._v(": message types, IBC events.")]),c._v(" "),a("li",[a("code",[c._v("x/module_name/client/cli")]),c._v(": CLI command to broadcast a transaction containing a message with a packet.")]),c._v(" "),a("li",[a("code",[c._v("x/module_name/oracle.go")]),c._v(": BandChain oracle packet handlers.")])]),c._v(" "),a("h2",{attrs:{id:"bandchain-oracle-scaffold-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bandchain-oracle-scaffold-example"}},[c._v("#")]),c._v(" BandChain Oracle Scaffold Example")]),c._v(" "),a("p",[c._v("The following command scaffolds the IBC-enabled oracle. by default, the Trustless Hub scaffold oracle for "),a("a",{attrs:{href:"https://laozi-testnet2.cosmoscan.io/oracle-script/37#bridge",target:"_blank",rel:"noopener noreferrer"}},[c._v("coin rates"),a("OutboundLink")],1),c._v(" request and result.")]),c._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"JCBUcnVzdGxlc3MgSHViIHNjYWZmb2xkIGNoYWluIGdpdGh1Yi5jb20vdGVzdC9pYmNvcmFjbGUgJmFtcDsmYW1wOyBjZCBpYmNvcmFjbGUgCiQgVHJ1c3RsZXNzIEh1YiBzY2FmZm9sZCBtb2R1bGUgY29uc3VtaW5nIC0taWJjCiQgVHJ1c3RsZXNzIEh1YiBzIGJhbmQgY29pblJhdGVzIC0tbW9kdWxlIGNvbnN1bWluZwo="}}),c._v(" "),a("p",[c._v('Note: BandChain module uses version "bandchain-1". Make sure to update the '),a("code",[c._v("keys.go")]),c._v(" file accordingly.")]),c._v(" "),a("p",[a("code",[c._v("x/ibcoracle/types/keys.go")])]),c._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Y29uc3QgVmVyc2lvbiA9ICZxdW90O2JhbmRjaGFpbi0xJnF1b3Q7Cg=="}}),c._v(" "),a("p",[c._v("After scaffold and change the data, configure and run the Trustless Hub relayer.")]),c._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"JCBUcnVzdGxlc3MgSHViIHJlbGF5ZXIgY29uZmlndXJlIC1hIFwKLS1zb3VyY2UtcnBjICZxdW90O2h0dHA6Ly9ycGMtbGFvemktdGVzdG5ldDIuYmFuZGNoYWluLm9yZzoyNjY1NyZxdW90OyBcCi0tc291cmNlLWZhdWNldCAmcXVvdDtodHRwczovL2xhb3ppLXRlc3RuZXQyLmJhbmRjaGFpbi5vcmcvZmF1Y2V0L3JlcXVlc3QmcXVvdDsgXAotLXNvdXJjZS1wb3J0ICZxdW90O29yYWNsZSZxdW90OyBcCi0tc291cmNlLWdhc3ByaWNlICZxdW90OzB1YmFuZCZxdW90OyBcCi0tc291cmNlLWdhc2xpbWl0IDUwMDAwMDAgXAotLXNvdXJjZS1wcmVmaXggJnF1b3Q7YmFuZCZxdW90OyBcCi0tc291cmNlLXZlcnNpb24gJnF1b3Q7YmFuZGNoYWluLTEmcXVvdDsgXAotLXRhcmdldC1ycGMgJnF1b3Q7aHR0cDovL2xvY2FsaG9zdDoyNjY1NyZxdW90OyBcCi0tdGFyZ2V0LWZhdWNldCAmcXVvdDtodHRwOi8vbG9jYWxob3N0OjQ1MDAmcXVvdDsgXAotLXRhcmdldC1wb3J0ICZxdW90O2NvbnN1bWluZyZxdW90OyBcCi0tdGFyZ2V0LWdhc3ByaWNlICZxdW90OzAuMHN0YWtlJnF1b3Q7IFwKLS10YXJnZXQtZ2FzbGltaXQgMzAwMDAwIFwKLS10YXJnZXQtcHJlZml4ICZxdW90O2Nvc21vcyZxdW90OyAgXAotLXRhcmdldC12ZXJzaW9uICZxdW90O2JhbmRjaGFpbi0xJnF1b3Q7CiAgICAgICAgICAgIAokIFRydXN0bGVzcyBIdWIgcmVsYXllciBjb25uZWN0Cg=="}}),c._v(" "),a("p",[c._v("Make a request transaction, passing the script id.")]),c._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"IyBDb2luIFJhdGVzIChzY3JpcHQgMzcgaW50byB0aGUgdGVzdG5ldCkKJCBpYmNvcmFjbGVkIHR4IGNvbnN1bWluZyBjb2luLXJhdGVzLWRhdGEgMzcgNCAzIC0tY2hhbm5lbCBjaGFubmVsLTAgLS1zeW1ib2xzICZxdW90O0JUQyxFVEgsWFJQLEJDSCZxdW90OyAtLW11bHRpcGxpZXIgMTAwMDAwMCAtLWZlZS1saW1pdCAzMHViYW5kIC0tcmVxdWVzdC1rZXkgJnF1b3Q7cmFuZG9tX3N0cmluZyZxdW90OyAtLXByZXBhcmUtZ2FzIDYwMDAwMCAtLWV4ZWN1dGUtZ2FzIDYwMDAwMCAtLWZyb20gYWxpY2UgLS1jaGFpbi1pZCBpYmNvcmFjbGUK"}}),c._v(" "),a("p",[c._v("You can check the last request id returned by ack.")]),c._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"JCBpYmNvcmFjbGVkIHF1ZXJ5IGNvbnN1bWluZyBsYXN0LWNvaW4tcmF0ZXMtaWQKcmVxdWVzdF9pZDogJnF1b3Q7MTAxMjc2JnF1b3Q7Cg=="}}),c._v(" "),a("p",[c._v("Furthermore, check the data by request id receive the data packet.")]),c._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"JCBpYmNvcmFjbGVkIHF1ZXJ5IGNvbnN1bWluZyBjb2luLXJhdGVzLXJlc3VsdCAxMDEyNzYK"}}),c._v(" "),a("h3",{attrs:{id:"multiple-oracles"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#multiple-oracles"}},[c._v("#")]),c._v(" Multiple oracles")]),c._v(" "),a("p",[c._v("You can scaffold multiples oracles by module. After scaffold, you must change the "),a("code",[c._v("Calldata")]),c._v(" and "),a("code",[c._v("Result")]),c._v(" parameters into the proto file "),a("code",[c._v("moduleName.proto")]),c._v(" and adapt the request into the  "),a("code",[c._v("cli/client/tx_module_name.go")]),c._v(" file. Let's create an example to return the "),a("a",{attrs:{href:"https://laozi-testnet2.cosmoscan.io/oracle-script/33#bridge",target:"_blank",rel:"noopener noreferrer"}},[c._v("gold price"),a("OutboundLink")],1),c._v(":")]),c._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"JCBUcnVzdGxlc3MgSHViIHMgYmFuZCBnb2xkUHJpY2UgLS1tb2R1bGUgY29uc3VtaW5nCg=="}}),c._v(" "),a("p",[a("code",[c._v("proto/gold_price.proto")]),c._v(":")]),c._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"protobuf",base64:"c3ludGF4ID0gJnF1b3Q7cHJvdG8zJnF1b3Q7OwpwYWNrYWdlIHRlc3QuaWJjb3JhY2xlLmNvbnN1bWluZzsKCm9wdGlvbiBnb19wYWNrYWdlID0gJnF1b3Q7Z2l0aHViLmNvbS90ZXN0L2liY29yYWNsZS94L2NvbnN1bWluZy90eXBlcyZxdW90OzsKCm1lc3NhZ2UgR29sZFByaWNlQ2FsbERhdGEgewogIHVpbnQ2NCBtdWx0aXBsaWVyID0gMjsKfQoKbWVzc2FnZSBHb2xkUHJpY2VSZXN1bHQgewogIHVpbnQ2NCBwcmljZSA9IDE7Cn0K"}}),c._v(" "),a("p",[a("code",[c._v("x/cli/client/tx_gold_price.go")]),c._v(":")]),c._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"cGFja2FnZSBjbGkKCmltcG9ydCAoCgkmcXVvdDtzdHJjb252JnF1b3Q7CgoJJnF1b3Q7Z2l0aHViLmNvbS9zcGYxMy9jb2JyYSZxdW90OwoKCSZxdW90O2dpdGh1Yi5jb20vY29zbW9zL2Nvc21vcy1zZGsvY2xpZW50JnF1b3Q7CgkmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL2NsaWVudC9mbGFncyZxdW90OwoJJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvY29zbW9zLXNkay9jbGllbnQvdHgmcXVvdDsKCXNkayAmcXVvdDtnaXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrL3R5cGVzJnF1b3Q7CgkmcXVvdDtnaXRodWIuY29tL3RlbmRlcm1pbnQvdGVzdC94L2NvbnN1bWluZy90eXBlcyZxdW90OwopCgovLyBDbWRSZXF1ZXN0R29sZFByaWNlRGF0YSBjcmVhdGVzIGFuZCBicm9hZGNhc3QgYSBHb2xkUHJpY2UgcmVxdWVzdCB0cmFuc2FjdGlvbgpmdW5jIENtZFJlcXVlc3RHb2xkUHJpY2VEYXRhKCkgKmNvYnJhLkNvbW1hbmQgewoJY21kIDo9ICZhbXA7Y29icmEuQ29tbWFuZHsKCQlVc2U6ICAgJnF1b3Q7Z29sZC1wcmljZS1kYXRhIFtvcmFjbGUtc2NyaXB0LWlkXSBbcmVxdWVzdGVkLXZhbGlkYXRvci1jb3VudF0gW3N1ZmZpY2llbnQtdmFsaWRhdG9yLWNvdW50XSZxdW90OywKCQlTaG9ydDogJnF1b3Q7TWFrZSBhIG5ldyBHb2xkUHJpY2UgcXVlcnkgcmVxdWVzdCB2aWEgYW4gZXhpc3RpbmcgQmFuZENoYWluIG9yYWNsZSBzY3JpcHQmcXVvdDssCgkJQXJnczogIGNvYnJhLkV4YWN0QXJncygzKSwKCQlSdW5FOiBmdW5jKGNtZCAqY29icmEuQ29tbWFuZCwgYXJncyBbXXN0cmluZykgZXJyb3IgewoJCQkvLyByZXRyaWV2ZSB0aGUgb3JhY2xlIHNjcmlwdCBpZC4KCQkJdWludDY0T3JhY2xlU2NyaXB0SUQsIGVyciA6PSBzdHJjb252LlBhcnNlVWludChhcmdzWzBdLCAxMCwgNjQpCgkJCWlmIGVyciAhPSBuaWwgewoJCQkJcmV0dXJuIGVycgoJCQl9CgkJCW9yYWNsZVNjcmlwdElEIDo9IHR5cGVzLk9yYWNsZVNjcmlwdElEKHVpbnQ2NE9yYWNsZVNjcmlwdElEKQoKCQkJLy8gcmV0cmlldmUgdGhlIHJlcXVlc3RlZCB2YWxpZGF0b3IgY291bnQuCgkJCWFza0NvdW50LCBlcnIgOj0gc3RyY29udi5QYXJzZVVpbnQoYXJnc1sxXSwgMTAsIDY0KQoJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCXJldHVybiBlcnIKCQkJfQoKCQkJLy8gcmV0cmlldmUgdGhlIHN1ZmZpY2llbnQobWluaW11bSkgdmFsaWRhdG9yIGNvdW50LgoJCQltaW5Db3VudCwgZXJyIDo9IHN0cmNvbnYuUGFyc2VVaW50KGFyZ3NbMl0sIDEwLCA2NCkKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQlyZXR1cm4gZXJyCgkJCX0KCgkJCWNoYW5uZWwsIGVyciA6PSBjbWQuRmxhZ3MoKS5HZXRTdHJpbmcoZmxhZ0NoYW5uZWwpCgkJCWlmIGVyciAhPSBuaWwgewoJCQkJcmV0dXJuIGVycgoJCQl9CgoJCQkvLyByZXRyaWV2ZSB0aGUgbXVsdGlwbGllciBmb3IgdGhlIHN5bWJvbHMnIHByaWNlLgoJCQltdWx0aXBsaWVyLCBlcnIgOj0gY21kLkZsYWdzKCkuR2V0VWludDY0KGZsYWdNdWx0aXBsaWVyKQoJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCXJldHVybiBlcnIKCQkJfQoKCQkJY2FsbGRhdGEgOj0gJmFtcDt0eXBlcy5Hb2xkUHJpY2VDYWxsRGF0YXsKCQkJCU11bHRpcGxpZXI6IG11bHRpcGxpZXIsCgkJCX0KCgkJCS8vIHJldHJpZXZlIHRoZSBhbW91bnQgb2YgY29pbnMgYWxsb3dlZCB0byBiZSBwYWlkIGZvciBvcmFjbGUgcmVxdWVzdCBmZWUgZnJvbSB0aGUgcG9vbCBhY2NvdW50LgoJCQljb2luU3RyLCBlcnIgOj0gY21kLkZsYWdzKCkuR2V0U3RyaW5nKGZsYWdGZWVMaW1pdCkKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQlyZXR1cm4gZXJyCgkJCX0KCQkJZmVlTGltaXQsIGVyciA6PSBzZGsuUGFyc2VDb2luc05vcm1hbGl6ZWQoY29pblN0cikKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQlyZXR1cm4gZXJyCgkJCX0KCgkJCS8vIHJldHJpZXZlIHRoZSByZXF1ZXN0IGtleSBjb3JyZXNwb25kaW5nIHRvIHRoZSBwb29sIGFjY291bnQgKHVzZWQgdG8gcGF5IGZlZSkgb24gQmFuZENoYWluLgoJCQlyZXF1ZXN0S2V5LCBlcnIgOj0gY21kLkZsYWdzKCkuR2V0U3RyaW5nKGZsYWdSZXF1ZXN0a2V5KQoJCQlpZiBlcnIgIT0gbmlsIHsKCQkJCXJldHVybiBlcnIKCQkJfQoKCQkJLy8gcmV0cmlldmUgdGhlIGFtb3VudCBvZiBnYXMgYWxsb3dlZCBmb3IgdGhlIHByZXBhcmUgc3RlcCBvZiB0aGUgb3JhY2xlIHNjcmlwdC4KCQkJcHJlcGFyZUdhcywgZXJyIDo9IGNtZC5GbGFncygpLkdldFVpbnQ2NChmbGFnUHJlcGFyZUdhcykKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQlyZXR1cm4gZXJyCgkJCX0KCgkJCS8vIHJldHJpZXZlIHRoZSBhbW91bnQgb2YgZ2FzIGFsbG93ZWQgZm9yIHRoZSBleGVjdXRlIHN0ZXAgb2YgdGhlIG9yYWNsZSBzY3JpcHQuCgkJCWV4ZWN1dGVHYXMsIGVyciA6PSBjbWQuRmxhZ3MoKS5HZXRVaW50NjQoZmxhZ0V4ZWN1dGVHYXMpCgkJCWlmIGVyciAhPSBuaWwgewoJCQkJcmV0dXJuIGVycgoJCQl9CgoJCQljbGllbnRDdHgsIGVyciA6PSBjbGllbnQuR2V0Q2xpZW50VHhDb250ZXh0KGNtZCkKCQkJaWYgZXJyICE9IG5pbCB7CgkJCQlyZXR1cm4gZXJyCgkJCX0KCgkJCW1zZyA6PSB0eXBlcy5OZXdNc2dHb2xkUHJpY2VEYXRhKAoJCQkJY2xpZW50Q3R4LkdldEZyb21BZGRyZXNzKCkuU3RyaW5nKCksCgkJCQlvcmFjbGVTY3JpcHRJRCwKCQkJCWNoYW5uZWwsCgkJCQljYWxsZGF0YSwKCQkJCWFza0NvdW50LAoJCQkJbWluQ291bnQsCgkJCQlmZWVMaW1pdCwKCQkJCXJlcXVlc3RLZXksCgkJCQlwcmVwYXJlR2FzLAoJCQkJZXhlY3V0ZUdhcywKCQkJKQoJCQlpZiBlcnIgOj0gbXNnLlZhbGlkYXRlQmFzaWMoKTsgZXJyICE9IG5pbCB7CgkJCQlyZXR1cm4gZXJyCgkJCX0KCQkJcmV0dXJuIHR4LkdlbmVyYXRlT3JCcm9hZGNhc3RUeENMSShjbGllbnRDdHgsIGNtZC5GbGFncygpLCBtc2cpCgkJfSwKCX0KCgljbWQuRmxhZ3MoKS5TdHJpbmcoZmxhZ0NoYW5uZWwsICZxdW90OyZxdW90OywgJnF1b3Q7VGhlIGNoYW5uZWwgaWQmcXVvdDspCgljbWQuTWFya0ZsYWdSZXF1aXJlZChmbGFnQ2hhbm5lbCkKCWNtZC5GbGFncygpLlVpbnQ2NChmbGFnTXVsdGlwbGllciwgMTAwMDAwMCwgJnF1b3Q7TXVsdGlwbGllciB1c2VkIGluIGNhbGxpbmcgdGhlIG9yYWNsZSBzY3JpcHQmcXVvdDspCgljbWQuRmxhZ3MoKS5TdHJpbmcoZmxhZ0ZlZUxpbWl0LCAmcXVvdDsmcXVvdDssICZxdW90O3RoZSBtYXhpbXVtIHRva2VucyB0aGF0IHdpbGwgYmUgcGFpZCB0byBhbGwgZGF0YSBzb3VyY2UgcHJvdmlkZXJzJnF1b3Q7KQoJY21kLkZsYWdzKCkuU3RyaW5nKGZsYWdSZXF1ZXN0a2V5LCAmcXVvdDsmcXVvdDssICZxdW90O0tleSBmb3IgZ2VuZXJhdGluZyBlc2Nyb3cgYWRkcmVzcyZxdW90OykKCWNtZC5GbGFncygpLlVpbnQ2NChmbGFnUHJlcGFyZUdhcywgMjAwMDAwLCAmcXVvdDtQcmVwYXJlIGdhcyB1c2VkIGluIGZlZSBjb3VudGluZyBmb3IgcHJlcGFyZSByZXF1ZXN0JnF1b3Q7KQoJY21kLkZsYWdzKCkuVWludDY0KGZsYWdFeGVjdXRlR2FzLCAyMDAwMDAsICZxdW90O0V4ZWN1dGUgZ2FzIHVzZWQgaW4gZmVlIGNvdW50aW5nIGZvciBleGVjdXRlIHJlcXVlc3QmcXVvdDspCglmbGFncy5BZGRUeEZsYWdzVG9DbWQoY21kKQoKCXJldHVybiBjbWQKfQo="}}),c._v(" "),a("p",[c._v("Make the request transaction.")]),c._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"IyBHb2xkIFByaWNlIChzY3JpcHQgMzMgaW50byB0aGUgdGVzdG5ldCkKJCBpYmNvcmFjbGVkIHR4IGNvbnN1bWluZyBnb2xkLXByaWNlLWRhdGEgMzMgNCAzIC0tY2hhbm5lbCBjaGFubmVsLTAgLS1tdWx0aXBsaWVyIDEwMDAwMDAgLS1mZWUtbGltaXQgMzB1YmFuZCAtLXJlcXVlc3Qta2V5ICZxdW90O3JhbmRvbV9zdHJpbmcmcXVvdDsgLS1wcmVwYXJlLWdhcyA2MDAwMDAgLS1leGVjdXRlLWdhcyA2MDAwMDAgLS1mcm9tIGFsaWNlIC0tY2hhaW4taWQgaWJjb3JhY2xlCg=="}}),c._v(" "),a("p",[c._v("Check the last request id returned by ack and the package data.")]),c._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"JCBpYmNvcmFjbGVkIHF1ZXJ5IGNvbnN1bWluZyBsYXN0LWdvbGQtcHJpY2UtaWQKcmVxdWVzdF9pZDogJnF1b3Q7MTAxMjkwJnF1b3Q7CgokIGliY29yYWNsZWQgcXVlcnkgY29uc3VtaW5nIGdvbGQtcHJpY2UtcmVzdWx0IDEwMTI5MAo="}})],1)}),[],!1,null,null,null);l.default=e.exports}}]);