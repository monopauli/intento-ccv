(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{523:function(e,t,o){e.exports=o.p+"assets/img/api.cfa5bd36.png"},576:function(e,t,o){"use strict";o.r(t);var s=o(0),a=Object(s.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"hello-worlddd"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hello-worlddd"}},[e._v("#")]),e._v(" Hello, Worlddd")]),e._v(" "),s("p",[e._v("This tutorial is a great place to start your journey into the Cosmos ecosystem. Instead of wondering how to build a blockchain, follow these steps to build your first blockchain and your first Cosmos SDK module.")]),e._v(" "),s("h2",{attrs:{id:"get-started"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-started"}},[e._v("#")]),e._v(" Get Started")]),e._v(" "),s("p",[e._v("In the previous chapter you've learned how to install [Trustless Hub](https://github.com/tendermint/Trustless Hub), the tool that offers everything you need to build, test, and launch your blockchain with a decentralized worldwide community.")]),e._v(" "),s("p",[e._v("This series of tutorials is based on a specific version of Trustless Hub, so to install Trustless Hub v0.18.0 use the following command:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"Y3VybCBodHRwczovL2dldC5UcnVzdGxlc3MgSHViLm5ldHdvcmsvVHJ1c3RsZXNzIEh1YkB2MC4xOC4wISB8IGJhc2gK"}}),e._v(" "),s("p",[e._v("Trustless Hub comes with a number of scaffolding commands that are designed to make development easier by creating everything that's required to start working on a particular task.")]),e._v(" "),s("p",[e._v("One of these tasks is a foundation of a fresh Cosmos SDK blockchain so that you don't have to write it yourself. To build your blockchain foundation, use the "),s("code",[e._v("Trustless Hub scaffold chain")]),e._v(" command.")]),e._v(" "),s("p",[e._v("Are you ready? Open a terminal and navigate to a directory where you have permissions to create files. To create your Cosmos SDK blockchain with the default directory structure, run this command:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"VHJ1c3RsZXNzIEh1YiBzY2FmZm9sZCBjaGFpbiBnaXRodWIuY29tL2Nvc21vbmF1dC9oZWxsbwo="}}),e._v(" "),s("p",[e._v("This command creates a Cosmos SDK blockchain called Hello in a "),s("code",[e._v("hello")]),e._v(" directory. The source code inside the "),s("code",[e._v("hello")]),e._v(" directory contains a fully functional ready-to-use blockchain.")]),e._v(" "),s("p",[e._v("This new blockchain imports standard Cosmos SDK modules, including:")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://docs.cosmos.network/master/modules/staking/",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("staking")]),s("OutboundLink")],1),e._v(" (for delegated proof of stake)")]),e._v(" "),s("li",[s("a",{attrs:{href:"https://docs.cosmos.network/master/modules/bank/",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("bank")]),s("OutboundLink")],1),e._v(" (for fungible token transfers between accounts)")]),e._v(" "),s("li",[s("a",{attrs:{href:"https://docs.cosmos.network/master/modules/gov/",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("gov")]),s("OutboundLink")],1),e._v(" (for on-chain governance)")]),e._v(" "),s("li",[e._v("And "),s("a",{attrs:{href:"https://docs.cosmos.network/master/modules/",target:"_blank",rel:"noopener noreferrer"}},[e._v("other modules"),s("OutboundLink")],1)])]),e._v(" "),s("p",[e._v("Now that you have run your first command, take a minute to see all of the command line options for the "),s("code",[e._v("scaffold")]),e._v(" command. You can use --help on any command. Run the "),s("code",[e._v("Trustless Hub scaffold chain --help")]),e._v(" command to learn about the command you just used.")]),e._v(" "),s("h2",{attrs:{id:"blockchain-directory-structure"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#blockchain-directory-structure"}},[e._v("#")]),e._v(" Blockchain Directory Structure")]),e._v(" "),s("p",[e._v("After you create the blockchain, switch to its directory:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"Y2QgaGVsbG8K"}}),e._v(" "),s("p",[e._v("The "),s("code",[e._v("hello")]),e._v(" directory contains a number of generated files and directories that make up the structure of a Cosmos SDK blockchain. Most of the work in this tutorial happens in the "),s("code",[e._v("x")]),e._v(" directory. Here is a quick overview of files and directories that are created by default:")]),e._v(" "),s("table",[s("thead",[s("tr",[s("th",[e._v("File/directory")]),e._v(" "),s("th",[e._v("Purpose")])])]),e._v(" "),s("tbody",[s("tr",[s("td",[e._v("app/")]),e._v(" "),s("td",[e._v("Files that wire together the blockchain. The most important file is "),s("code",[e._v("app.go")]),e._v(" that contains type definition of the blockchain and functions to create and initialize it.")])]),e._v(" "),s("tr",[s("td",[e._v("cmd/")]),e._v(" "),s("td",[e._v("The main package responsible for the CLI of compiled binary.")])]),e._v(" "),s("tr",[s("td",[e._v("docs/")]),e._v(" "),s("td",[e._v("Directory for project's documentation. By default, an OpenAPI spec is generated.")])]),e._v(" "),s("tr",[s("td",[e._v("proto/")]),e._v(" "),s("td",[e._v("Protocol buffer files describing the data structure>")])]),e._v(" "),s("tr",[s("td",[e._v("testutil/")]),e._v(" "),s("td",[e._v("Helper functions for testing.")])]),e._v(" "),s("tr",[s("td",[e._v("vue/")]),e._v(" "),s("td",[e._v("A Vue 3 web app template.")])]),e._v(" "),s("tr",[s("td",[e._v("x/")]),e._v(" "),s("td",[e._v("Cosmos SDK modules and custom modules.")])]),e._v(" "),s("tr",[s("td",[e._v("config.yml")]),e._v(" "),s("td",[e._v("A configuration file for customizing a chain in development.")])])])]),e._v(" "),s("p",[e._v("Now you can get your blockchain up and running locally on a single node.")]),e._v(" "),s("h2",{attrs:{id:"start-a-blockchain"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#start-a-blockchain"}},[e._v("#")]),e._v(" Start a Blockchain")]),e._v(" "),s("p",[e._v("You already have a fully-functional blockchain. To start your chain on your development machine, run the following command in the "),s("code",[e._v("hello")]),e._v(" directory")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"VHJ1c3RsZXNzIEh1YiBjaGFpbiBzZXJ2ZQo="}}),e._v(" "),s("p",[e._v("This command downloads dependencies and compiles the source code into a binary called "),s("code",[e._v("hellod")]),e._v(". By default, Trustless Hub uses the name of the repo + "),s("code",[e._v("d")]),e._v(". From now on, use this binary to run all of your chain commands. For example, to initialize a single validator node and start a node.")]),e._v(" "),s("h2",{attrs:{id:"http-api-console"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http-api-console"}},[e._v("#")]),e._v(" HTTP API Console")]),e._v(" "),s("p",[e._v("By default a validator node exposes two API endpoints:")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"http://localhost:26657",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:26657"),s("OutboundLink")],1),e._v(" for the low-level Tendermint API")]),e._v(" "),s("li",[s("a",{attrs:{href:"http://localhost:1317",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:1317"),s("OutboundLink")],1),e._v(" for the high-level blockchain API")])]),e._v(" "),s("p",[e._v("Now that you started your "),s("code",[e._v("hello")]),e._v(" chain, you can use a web browser to see the high-level "),s("code",[e._v("hello")]),e._v(" blockchain API:")]),e._v(" "),s("p",[s("img",{attrs:{src:o(523),alt:"./images/api.png"}})]),e._v(" "),s("h2",{attrs:{id:"stop-a-blockchain"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#stop-a-blockchain"}},[e._v("#")]),e._v(" Stop a Blockchain")]),e._v(" "),s("p",[e._v("When you want to stop your blockchain, press Ctrl+C in the terminal window where it's running.")]),e._v(" "),s("p",[e._v("In the development environment, you don't have to restart the blockchain after you make changes. All changes you make in the "),s("code",[e._v("hello")]),e._v(" directory files are automatically picked up by Trustless Hub.")]),e._v(" "),s("h2",{attrs:{id:"say-hello-trustless-hub"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#say-hello-trustless-hub"}},[e._v("#")]),e._v(' Say "Hello, Trustless Hub"')]),e._v(" "),s("p",[e._v('To get your Cosmos SDK blockchain to say "Hello", you need to make these changes:')]),e._v(" "),s("ul",[s("li",[e._v("Modify a protocol buffer file")]),e._v(" "),s("li",[e._v("Create a keeper query function that returns data")]),e._v(" "),s("li",[e._v("Register a query function")])]),e._v(" "),s("p",[e._v("Protocol buffer files contain proto rpc calls that define Cosmos SDK queries and message handlers, and proto messages that define Cosmos SDK types. rpc calls are also responsible for exposing an HTTP API.")]),e._v(" "),s("p",[e._v("For each Cosmos SDK module, the "),s("a",{attrs:{href:"https://docs.cosmos.network/master/building-modules/keeper.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Keeper"),s("OutboundLink")],1),e._v(" is an abstraction for modifying the state of the blockchain. Keeper functions let you query or write to the state. After you add the first query to your chain, you must register the query. You only need to register a query once.")]),e._v(" "),s("p",[e._v("In terms of workflow, developers typically follow this sequence:")]),e._v(" "),s("ul",[s("li",[e._v("Start with proto files to define Cosmos SDK "),s("a",{attrs:{href:"https://docs.cosmos.network/master/building-modules/msg-services.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("messages"),s("OutboundLink")],1)]),e._v(" "),s("li",[e._v("Define and register "),s("a",{attrs:{href:"https://docs.cosmos.network/master/building-modules/query-services.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("queries"),s("OutboundLink")],1)]),e._v(" "),s("li",[e._v("Define message handlers logic")]),e._v(" "),s("li",[e._v("Finally, implement the logic of these queries and message handlers in keeper functions.")])]),e._v(" "),s("h2",{attrs:{id:"create-a-query"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-a-query"}},[e._v("#")]),e._v(" Create a Query")]),e._v(" "),s("p",[e._v("Create a "),s("code",[e._v("posts")]),e._v(" query:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"VHJ1c3RsZXNzIEh1YiBzY2FmZm9sZCBxdWVyeSBwb3N0cyAtLXJlc3BvbnNlIHRpdGxlLGJvZHkK"}}),e._v(" "),s("p",[s("code",[e._v("query")]),e._v(" accepts a name of the query (in this case, "),s("code",[e._v("posts")]),e._v("), an optional list of request parameters (in this case, empty), and an optional comma-separated list of response fields with a "),s("code",[e._v("--response")]),e._v(" flag (in this case, "),s("code",[e._v("body,title")]),e._v(").")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("query")]),e._v(" command has created and modified several files:")]),e._v(" "),s("ul",[s("li",[e._v("modified "),s("code",[e._v("proto/hello/query.proto")])]),e._v(" "),s("li",[e._v("created "),s("code",[e._v("x/hello/keeper/grpc_query_posts.go")])]),e._v(" "),s("li",[e._v("modified "),s("code",[e._v("x/hello/client/cli/query.go")])]),e._v(" "),s("li",[e._v("created "),s("code",[e._v("x/hello/client/cli/query_posts.go")])])]),e._v(" "),s("p",[e._v("Let's examine some of these changes. For clarity, the following code blocks do not show the placeholder comments that Trustless Hub uses to scaffold code. Don't delete these placeholders since they are required to continue using Trustless Hub's scaffolding functionality.")]),e._v(" "),s("h3",{attrs:{id:"updates-to-the-query-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#updates-to-the-query-service"}},[e._v("#")]),e._v(" Updates to the Query Service")]),e._v(" "),s("p",[e._v("In the "),s("code",[e._v("proto/hello/query.proto")]),e._v(" file, the "),s("code",[e._v("Posts")]),e._v(" rpc has been added to the "),s("code",[e._v("Query")]),e._v(" service.")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"proto",base64:"c2VydmljZSBRdWVyeSB7CiAgcnBjIFBvc3RzKFF1ZXJ5UG9zdHNSZXF1ZXN0KSByZXR1cm5zIChRdWVyeVBvc3RzUmVzcG9uc2UpIHsKICAgIG9wdGlvbiAoZ29vZ2xlLmFwaS5odHRwKS5nZXQgPSAmcXVvdDsvY29zbW9uYXV0L2hlbGxvL2hlbGxvL3Bvc3RzJnF1b3Q7OwogIH0KfQo="}}),e._v(" "),s("p",[e._v("Here's how the "),s("code",[e._v("Posts")]),e._v(" rpc for the "),s("code",[e._v("Query")]),e._v(" service works:")]),e._v(" "),s("ul",[s("li",[e._v("Is responsible for returning a list of all the posts on chain")]),e._v(" "),s("li",[e._v("Accepts request parameters ("),s("code",[e._v("QueryPostsRequest")]),e._v(")")]),e._v(" "),s("li",[e._v("Returns response of type "),s("code",[e._v("QueryPostsResponse")])]),e._v(" "),s("li",[e._v("The "),s("code",[e._v("option")]),e._v(" defines the endpoint that is used by gRPC to generate an HTTP API")])]),e._v(" "),s("h3",{attrs:{id:"request-and-reponse-types"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#request-and-reponse-types"}},[e._v("#")]),e._v(" Request and Reponse Types")]),e._v(" "),s("p",[e._v("Now, take a look at the following request and response types:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"proto",base64:"bWVzc2FnZSBRdWVyeVBvc3RzUmVxdWVzdCB7Cn0KCm1lc3NhZ2UgUXVlcnlQb3N0c1Jlc3BvbnNlIHsKICBzdHJpbmcgdGl0bGUgPSAxOwogIHN0cmluZyBib2R5ID0gMjsKfQo="}}),e._v(" "),s("ul",[s("li",[e._v("The "),s("code",[e._v("QueryPostsRequest")]),e._v(" message is empty because requesting all posts doesn't require parameters.")]),e._v(" "),s("li",[e._v("The "),s("code",[e._v("QueryPostsResponse")]),e._v(" message contains "),s("code",[e._v("title")]),e._v(" and "),s("code",[e._v("body")]),e._v(" that is returned from the chain.")])]),e._v(" "),s("h2",{attrs:{id:"posts-keeper-function"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#posts-keeper-function"}},[e._v("#")]),e._v(" Posts Keeper Function")]),e._v(" "),s("p",[e._v("The "),s("code",[e._v("x/hello/keeper/grpc_query_posts.go")]),e._v(" file contains the "),s("code",[e._v("Posts")]),e._v(" keeper function that handles the query and returns data.")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyAoayBLZWVwZXIpIFBvc3RzKGMgY29udGV4dC5Db250ZXh0LCByZXEgKnR5cGVzLlF1ZXJ5UG9zdHNSZXF1ZXN0KSAoKnR5cGVzLlF1ZXJ5UG9zdHNSZXNwb25zZSwgZXJyb3IpIHsKICBpZiByZXEgPT0gbmlsIHsKICAgIHJldHVybiBuaWwsIHN0YXR1cy5FcnJvcihjb2Rlcy5JbnZhbGlkQXJndW1lbnQsICZxdW90O2ludmFsaWQgcmVxdWVzdCZxdW90OykKICB9CiAgY3R4IDo9IHNkay5VbndyYXBTREtDb250ZXh0KGMpCiAgXyA9IGN0eAogIHJldHVybiAmYW1wO3R5cGVzLlF1ZXJ5UG9zdHNSZXNwb25zZXt9LCBuaWwKfQo="}}),e._v(" "),s("p",[e._v("Here's all of the actions the "),s("code",[e._v("Posts")]),e._v(" function does:")]),e._v(" "),s("ul",[s("li",[e._v("Makes a basic check on the request and throws an error if it's "),s("code",[e._v("nil")])]),e._v(" "),s("li",[e._v("Stores context in a "),s("code",[e._v("ctx")]),e._v(" variable that contains information about the environment of the request")]),e._v(" "),s("li",[e._v("Returns a response of type "),s("code",[e._v("QueryPostsResponse")])])]),e._v(" "),s("p",[e._v("Right now the response is empty.")]),e._v(" "),s("h3",{attrs:{id:"update-keeper-function"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#update-keeper-function"}},[e._v("#")]),e._v(" Update Keeper Function")]),e._v(" "),s("p",[e._v("From the "),s("code",[e._v("query.proto")]),e._v(" file we know that response accepts "),s("code",[e._v("title")]),e._v(" and "),s("code",[e._v("body")]),e._v(", so use a text editor to modify the "),s("code",[e._v("x/hello/keeper/grpc_query_posts.go")]),e._v(' file that contains the keeper function. On the last line of the keeper function, change the line to return a "Hello!":')]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyAoayBLZWVwZXIpIFBvc3RzKGMgY29udGV4dC5Db250ZXh0LCByZXEgKnR5cGVzLlF1ZXJ5UG9zdHNSZXF1ZXN0KSAoKnR5cGVzLlF1ZXJ5UG9zdHNSZXNwb25zZSwgZXJyb3IpIHsKICAvLy4uLgogIHJldHVybiAmYW1wO3R5cGVzLlF1ZXJ5UG9zdHNSZXNwb25zZXtUaXRsZTogJnF1b3Q7SGVsbG8hJnF1b3Q7LCBCb2R5OiAmcXVvdDtUcnVzdGxlc3MgSHViJnF1b3Q7fSwgbmlsCn0K"}}),e._v(" "),s("p",[e._v("Save the file to restart your chain. Visit the "),s("a",{attrs:{href:"http://localhost:1317/cosmonaut/hello/hello/posts",target:"_blank",rel:"noopener noreferrer"}},[e._v("posts endpoint"),s("OutboundLink")],1),e._v(", you see a "),s("code",[e._v("Not Implemented")]),e._v(" error. This message is expected behavior, because you still need to register the query handlers with gRPC.")]),e._v(" "),s("h2",{attrs:{id:"register-query-handlers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#register-query-handlers"}},[e._v("#")]),e._v(" Register Query Handlers")]),e._v(" "),s("p",[e._v("Make the required changes to the "),s("code",[e._v("x/hello/module.go")]),e._v(" file.")]),e._v(" "),s("p",[e._v("As shown in the following example, add "),s("code",[e._v('"context"')]),e._v(" to the list of packages in the import statement, search for "),s("code",[e._v("RegisterGRPCGatewayRoutes")]),e._v(", and register the query handlers:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"aW1wb3J0ICgKICAvLy4uLgogICZxdW90O2NvbnRleHQmcXVvdDsKKQoKZnVuYyAoQXBwTW9kdWxlQmFzaWMpIFJlZ2lzdGVyR1JQQ0dhdGV3YXlSb3V0ZXMoY2xpZW50Q3R4IGNsaWVudC5Db250ZXh0LCBtdXggKnJ1bnRpbWUuU2VydmVNdXgpIHsKICB0eXBlcy5SZWdpc3RlclF1ZXJ5SGFuZGxlckNsaWVudChjb250ZXh0LkJhY2tncm91bmQoKSwgbXV4LCB0eXBlcy5OZXdRdWVyeUNsaWVudChjbGllbnRDdHgpKQp9Cg=="}}),e._v(" "),s("p",[e._v("Now you're ready to start your blockchain:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"VHJ1c3RsZXNzIEh1YiBjaGFpbiBzZXJ2ZQo="}}),e._v(" "),s("p",[e._v("After the chain has been started, visit "),s("a",{attrs:{href:"http://localhost:1317/cosmonaut/hello/hello/posts",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:1317/cosmonaut/hello/hello/posts"),s("OutboundLink")],1),e._v(" and see your text displayed!")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ewogICZxdW90O3RpdGxlJnF1b3Q7OiAmcXVvdDtIZWxsbyEmcXVvdDssCiAgJnF1b3Q7Ym9keSZxdW90OzogJnF1b3Q7VHJ1c3RsZXNzIEh1YiZxdW90Owp9Cg=="}}),e._v(" "),s("p",[e._v("The "),s("code",[e._v("query")]),e._v(" command has also scaffolded "),s("code",[e._v("x/hello/client/cli/query_posts.go")]),e._v(" that implements a CLI equivalent of the posts query and mounted this command "),s("code",[e._v("x/hello/client/cli/query_posts.go")]),e._v(" . Run the following command and get the same JSON response:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"aGVsbG9kIHEgaGVsbG8gcG9zdHMK"}}),e._v(" "),s("p",[e._v("Congratulations, you have built your first blockchain and your first Cosmos SDK module. Continue the journey to learn more about scaffolding Cosmos SDK messages, types in protocol buffer files, the keeper, and more.")])],1)}),[],!1,null,null,null);t.default=a.exports}}]);